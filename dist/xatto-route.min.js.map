{"version":3,"sources":["dist/xatto-route.js"],"names":["global","factory","exports","module","require","define","amd","xatto","this","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","getOrigin","loc","location","protocol","hostname","port","filter","Boolean","join","Route","_a","children","_b","xa","context","extra","attrs","window","flags","pattern","RegExp","source","slice","match","exec","pathname","child","attributes","route","params","groups","path","RouteLink","href","onclick","ctx","ext","defaultPrevented","button","altKey","metaKey","ctrlKey","shiftKey","target","mutate","currentTarget","preventDefault","history","pushState","x","setPopstateHandle","handle","addEventListener","removeEventListener"],"mappings":"CAAC,SAAUA,EAAQC,GACI,iBAAZC,SAA0C,oBAAXC,OAAyBF,EAAQC,QAASE,QAAQ,UACtE,mBAAXC,QAAyBA,OAAOC,IAAMD,OAAO,CAAC,UAAW,SAAUJ,GACzEA,EAASD,EAAO,eAAiB,GAAIA,EAAOO,OAHjD,CAIEC,KAAM,SAAWN,EAAQK,GAAS,aAiBhC,IAAIE,EAAW,WAQX,OAPAA,EAAWC,OAAOC,QAAU,SAAkBC,GAC1C,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KAAIN,EAAEM,GAAKL,EAAEK,IAE9E,OAAON,IAEKU,MAAMd,KAAMQ,YAGhC,SAASO,EAAOV,EAAGW,GACf,IAAIZ,EAAI,GACR,IAAK,IAAIM,KAAKL,EAAOH,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,IAAMM,EAAEC,QAAQP,GAAK,IAC9EN,EAAEM,GAAKL,EAAEK,IACb,GAAS,MAALL,GAAqD,mBAAjCH,OAAOgB,sBACtB,CAAA,IAAIZ,EAAI,EAAb,IAAgBI,EAAIR,OAAOgB,sBAAsBb,GAAIC,EAAII,EAAED,OAAQH,IAASU,EAAEC,QAAQP,EAAEJ,IAAM,IAC1FF,EAAEM,EAAEJ,IAAMD,EAAEK,EAAEJ,KACtB,OAAOF,EA6BX,SAASe,EAAUC,EAAKC,GAIpB,OAHgBD,EAAIE,UAAY,MAAQF,EAAIE,SAAYF,EAAIE,SAAWD,EAASC,UAG9D,MAFP,CAACF,EAAIG,SAAUH,EAAII,MAAMC,OAAOC,SAASC,KAAK,MAClD,CAACN,EAASE,SAAUF,EAASG,MAAMC,OAAOC,SAASC,KAAK,MA4CnEjC,EAAQkC,MAzER,SAAeC,EAAIC,GACf,IAAIC,EAAKF,EAAGG,GAAIC,EAAUF,EAAGE,QAASC,EAAQH,EAAGG,MAAOC,EAAQpB,EAAOc,EAAI,CAAC,OACxER,EAAWc,EAAMd,UAAYY,EAAQZ,UAAYa,EAAMb,UAAYe,OAAOf,SAC1EgB,EAAQF,EAAME,OAAS,KACvBC,EAAUH,EAAMG,QAChB,MAAQA,EACRA,EAAU,GAELA,aAAmBC,SACxBF,EAAQA,GAASC,EAAQD,OAAS,KAClCC,EAAUA,EAAQE,QAGtBF,EAAyB,OADzBA,EAAyB,MAAfA,EAAQ,GAAaA,EAAQG,MAAM,GAAKH,GAChC,GAAaA,EAAQG,MAAM,GAAKH,EAElD,IAAII,GADJJ,EAAU,IAAIC,OAAO,KAAOD,EAASD,IACjBM,KAAKtB,EAASuB,UAC9BC,EAAQf,EAAS,GACrB,OAAOY,GAASzC,EAAS,GAAI4C,EAAO,CAAEC,WAAY7C,EAAS,GAAI4C,EAAMC,WAAY,CAAEC,MAAO,CAC9E1B,SAAUA,EACVqB,MAAOA,EACPM,OAAQN,EAAMO,QAAU,GACxBC,KAAMR,EAAM,GACZJ,QAASA,QAoDzB5C,EAAQyD,UA1CR,SAAmBtB,EAAIC,GACnB,IAAII,EAAQL,EAAGG,GAAGE,MAAOC,EAAQpB,EAAOc,EAAI,CAAC,OACzCuB,EAAOjB,EAAMiB,KACbC,EAAUlB,EAAMkB,QAyBpB,OAxBAlB,EAAMkB,QAAU,SAAUrC,EAAGsC,EAAKC,GAI9B,GAHIF,GACAA,EAAQrC,EAAGsC,EAAKC,KAEfvC,EAAEwC,kBACa,IAAbxC,EAAEyC,QACDzC,EAAE0C,QACF1C,EAAE2C,SACF3C,EAAE4C,SACF5C,EAAE6C,UACc,WAAjB1B,EAAM2B,QACT,OAAO,SAAUC,EAAQ9B,GACrB,IAAIZ,EAAWc,EAAMd,UAAYY,EAAQZ,UAAYa,EAAMb,UAAYe,OAAOf,SAC9E,GAAIF,EAAUE,EAAUA,KAAcF,EAAUH,EAAEgD,cAAe3C,GAAW,CACxEL,EAAEiD,iBACF,IAAIrB,EAAWvB,EAASuB,SACpBQ,IAASR,IACTsB,QAAQC,UAAUvB,EAAU,GAAIQ,GAChCW,QAMZhE,EAAMqE,EAAE,IAAKnE,EAAS,GAAIkC,GAAQL,IAe9CpC,EAAQ2E,kBAZR,SAA2BN,GACvB,IAAIO,EAAS,SAAUtD,GACnB+C,KAGJ,OADAQ,iBAAiB,WAAYD,GACtB,WACHE,oBAAoB,WAAYF","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('xatto')) :\n    typeof define === 'function' && define.amd ? define(['exports', 'xatto'], factory) :\n    (factory((global['xatto-route'] = {}),global.xatto));\n}(this, (function (exports,xatto) { 'use strict';\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation. All rights reserved.\r\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\n    this file except in compliance with the License. You may obtain a copy of the\r\n    License at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\n    MERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\n    See the Apache Version 2.0 License for specific language governing permissions\r\n    and limitations under the License.\r\n    ***************************************************************************** */\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\r\n\r\n    function __rest(s, e) {\r\n        var t = {};\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n            t[p] = s[p];\r\n        if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n                t[p[i]] = s[p[i]];\r\n        return t;\r\n    }\n\n    function Route(_a, children) {\r\n        var _b = _a.xa, context = _b.context, extra = _b.extra, attrs = __rest(_a, [\"xa\"]);\r\n        var location = attrs.location || context.location || extra.location || window.location;\r\n        var flags = attrs.flags || null;\r\n        var pattern = attrs.pattern;\r\n        if (null == pattern) {\r\n            pattern = '';\r\n        }\r\n        else if (pattern instanceof RegExp) {\r\n            flags = flags || pattern.flags || null;\r\n            pattern = pattern.source;\r\n        }\r\n        pattern = pattern[0] === '^' ? pattern.slice(1) : pattern;\r\n        pattern = pattern[0] === '/' ? pattern.slice(1) : pattern;\r\n        pattern = new RegExp(\"^/\" + pattern, flags);\r\n        var match = pattern.exec(location.pathname);\r\n        var child = children[0];\r\n        return match && __assign({}, child, { attributes: __assign({}, child.attributes, { route: {\r\n                    location: location,\r\n                    match: match,\r\n                    params: match.groups || {},\r\n                    path: match[0],\r\n                    pattern: pattern,\r\n                } }) });\r\n    }\n\n    function getOrigin(loc, location) {\r\n        var protocol = (loc.protocol && ':' !== loc.protocol) ? loc.protocol : location.protocol;\r\n        var host = [loc.hostname, loc.port].filter(Boolean).join(\":\")\r\n            || [location.hostname, location.port].filter(Boolean).join(\":\");\r\n        return protocol + \"//\" + host;\r\n    }\r\n    function RouteLink(_a, children) {\r\n        var extra = _a.xa.extra, attrs = __rest(_a, [\"xa\"]);\r\n        var href = attrs.href;\r\n        var onclick = attrs.onclick;\r\n        attrs.onclick = function (e, ctx, ext) {\r\n            if (onclick) {\r\n                onclick(e, ctx, ext);\r\n            }\r\n            if (!e.defaultPrevented\r\n                && e.button === 0\r\n                && !e.altKey\r\n                && !e.metaKey\r\n                && !e.ctrlKey\r\n                && !e.shiftKey\r\n                && attrs.target !== \"_blank\") {\r\n                return function (mutate, context) {\r\n                    var location = attrs.location || context.location || extra.location || window.location;\r\n                    if (getOrigin(location, location) === getOrigin(e.currentTarget, location)) {\r\n                        e.preventDefault();\r\n                        var pathname = location.pathname;\r\n                        if (href !== pathname) {\r\n                            history.pushState(pathname, \"\", href);\r\n                            mutate();\r\n                        }\r\n                    }\r\n                };\r\n            }\r\n        };\r\n        return (xatto.x(\"a\", __assign({}, attrs), children));\r\n    }\n\n    function setPopstateHandle(mutate) {\r\n        var handle = function (e) {\r\n            mutate();\r\n        };\r\n        addEventListener('popstate', handle);\r\n        return function () {\r\n            removeEventListener('popstate', handle);\r\n        };\r\n    }\n\n    exports.Route = Route;\n    exports.RouteLink = RouteLink;\n    exports.setPopstateHandle = setPopstateHandle;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n"]}